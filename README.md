
# 推箱子小游戏设计

## 1. 项目背景
在一个迷宫式的地图中，玩家控制一个小人，任务是将所有的箱子推到目标位置。地图由空地、墙壁、箱子和目标位置构成。玩家可以通过移动与推箱子，调整其位置，使得所有箱子都被推到目标位置。

---

## 2. 项目目标
1. **功能实现**

    - 实现玩家的移动逻辑（上下左右）。
    - 实现推箱子功能，箱子能被推向相邻的空地。
    - 确保玩家不能推动超过一只箱子，避免推到墙壁或其他箱子上。
    - 判断游戏是否完成（所有箱子都到达目标位置）。
2. **地图渲染**
    - 使用 ASCII 字符绘制游戏地图。
    - 地图上包括墙壁、箱子、目标和玩家。
3. **用户界面**
    - 提供一个欢迎界面，允许玩家开始游戏或退出。
    - 允许选择关卡并开始游戏。
4. **文档编写**
    - 编写详细的开发文档，记录操作系统、IDE、项目背景、功能实现、使用说明和代码结构。
5. **测试与改进**
    - 进行全面的测试，确保游戏逻辑正常运行。
    - 提升游戏的流畅度和可玩性。

---
<!--pagebreak-->
## 3. 项目内容

### 3.0 项目内容

| 测试 | 重点 | 样例 |
| --- | --- | --- |
| 关卡 1 + 实时 | 是否能正确推动两箱到目标 | 操作序列见 5.2 |
| 关卡 2 + 编程 | 多箱多目标（至少3个箱子），固定体力，走一步需要1点体力，推箱子则需要2点体力，要在规定的体力内推完箱子，超出体力范围自动失败 | `WWASAD...` |
| 非法输入 | 玩家尝试推动墙壁/越界 | 输入 `X`、`U` 越界 |
| 撤销恢复 | `R R Z Z Y Y` 路径是否回退、复现 | 观察位置与体力 |
| 自定义关卡 | STDIN 读取文件后渲染正确 | 5.3 文件 |

### 3.1 基本功能
1. **欢迎与菜单界面**
    - 显示欢迎界面，允许玩家选择关卡并开始游戏。
    - 关卡 1：较简单的地图，箱子和目标少。
    - 关卡 2：更复杂的地图，箱子数量增加，同时加有体力限制。
    - 支持两种控制模式：实时模式和编程模式。(实时模式是指 每走一步输出一个结果，如demo所示；编程模式是指 给定一串移动指令，判断最后是否游戏胜利。建议使用实时模式！)

2. **地图与关卡加载**
    - 地图使用数字矩阵或ASCII码表示（见附录示例）。
    - 支持多个关卡（至少两个内置关卡）。
    - 每个关卡包括：
      - 玩家起始位置。
      - 若干个箱子。
      - 若干个目标位置。
      - 墙壁，无法穿越。
    - 使用标准输入（STDIN）加载和保存关卡。

3. **玩家移动与推箱子**
    - 玩家通过按 `W`、`A`、`S`、`D` 移动（上下左右）。
    - 玩家可以推箱子，但不能推到墙壁、其他箱子或越界。
    - 当玩家按下方向键时，如果该方向有箱子且箱子后面是空地/目标，则玩家将推箱子。

4. **游戏结束判定**
    - 当所有的箱子都推到目标位置时，游戏结束。

5. **结算界面**
    - 游戏结束后输出总结数据，包括：
      - 游戏结束原因（成功推到目标位置、玩家退出等）。
      - 玩家操作序列（用字母表示，如 `W`、`A`、`S`、`D`）。
      - 玩家移动过程中消耗的体力。

### 3.2 附加功能 
1. **撤销与恢复功能**
    - 当玩家按下 `Z` 时，撤销最近的一步移动。
    - 当玩家按下 `Y` 时，恢复被撤销的操作。

2. **游戏读档**
    - 退出游戏后，可回到上一次未完成的位置

3. **自动搜索路径**
    - 可自动实现路径搜索，完成关卡

---

## 4. 项目评分

### 4.1 基础部分

| 说明 | 分数 |
| --- | --- |   
| 代码编写规范（缩进合理，注释充分） | 5分 |
| 正确绘制地图 | 5分 |
| 正确读取地图文档 | 10分 |
| 正确响应用户指令（前进，后退，上移，下移，选择关卡） | 20分 |
| 游戏运行总体稳定正常，符合相关规定，不会异常退出，没有内存泄漏 | 10分 |
| 游戏结算正常，胜利、失败判定正常 | 5分 |
| 总分 | 55分 |

### 4.2 综合评价部分
|说明|分数|
| --- | --- |  
|程序鲁棒性（对于玩家的非法输入，能够正确处理以及给与相关提示。比如玩家在移动时输入除WASD其他的字符等）|5分|
|撤销与恢复功能（见3.2）|5分|
|游戏读档|5分|
|总分|15分|

### 4.3 面试部分
|说明|分数|
| --- | --- |  
|能否清晰解释程序结构，能否回答助教问题|30分|

注：面试环节表现极差，Project成绩直接以不合格论处。

### 4.4 附加分
|说明|分数|
| --- | --- |  
|完成自动搜索路径|10分|

注：附加分独立于总分，可在上述3节得分的基础上进行加分，但Project最高分仅为100分。

---

## 5. 示例

### 5.0 选择关卡

```
1. 关卡1
2. 关卡2

请输入你要选择的关卡：
```

### 5.1 关卡示例（一）

```
###### 
# .  #
#  $ #
#  @ #
###### 
```

| 符号 | 含义 |
| :---: | ---- |
| `#` | 墙壁 |
| `.` | 目标点 |
| `$` | 箱子 |
| `@` | 玩家 |
| 空格 | 空地 |

> **完成目标**：将箱子 `$` 推到目标 `.` 上。

### 5.2 典型操作序列

- **输入指令**（实时模式）：`U R U L`
- **解释**  
  1. `U`：将箱子上移  
  2. `R`：到箱子的右下方  
  3. `U`：到箱子右方
  4. `L`：将箱子推到目标位置   

- **示例结算输出**  

```
恭喜！所有箱子已到达目标！
行动路径：URUL
消耗的体力：7
<按任意键返回主界面>
```

### 5.3 自定义关卡文件示例

```
7 7               # 宽 高
3 3               # 玩家起始 (x y)
1 1 1 1 1 1 1
1 0 3 0 0 0 1
1 0 1 2 2 0 1
1 0 0 0 1 0 1
1 0 0 0 3 0 1
1 0 0 0 0 0 1
1 1 1 1 1 1 1
```

- `1` = 墙 (`#`)  
- `0` = 空地  
- `2` = 箱子 (`$`)  
- `3` = 目标 (`.`)

---

## 6. 要点

1. **环境**：Windows 10/11 / WSL + GCC 11
2. **功能列表**：与评分点一一对应
3. **代码结构图**：建议用 Mermaid / UML
4. **已知问题 & 改进计划**
---

## 7. 提交

1. 提交时间

提交时间截至为6月2日（周一）晚上24：00。未及时提交的Project须接受惩罚，以提交时间为准，每晚交一天，报告成绩降20%，5天未提交（截止2025年6月7日24:00未提交），project成绩为0。

2. 提交要求
必须把代码上传到学习通作业提交处！

## 8. 学术诚信

1. 禁止直接使用 AI大模型 生成整份代码；
2. 禁止代码抄袭；
3. 我们会对大家的代码进行 AI检测 以及 相似性核查 ，一经发现违反上述两条者，成绩直接降为0分，并按《复旦大学学生纪律处分条例》处理！ 

## 11. 其他

如对本Project有任何不理解之处，可以随时发邮件至 lzhou24@m.fudan.edu.cn。
注：仅解释题目含义，不提供思路解答，代码讲解。
